"use strict";(self.webpackChunkhmis=self.webpackChunkhmis||[]).push([[840],{840:(e,a,t)=>{t.r(a),t.d(a,{default:()=>c});var s=t(43),l=t(472),r=t(533),i=t(253),n=t(128),o=t(579);const c=()=>{const e={profilePicName:null,idDocumentName:null,firstName:"",middleName:"",lastName:"",dob:"",genderId:"",address1:"",countryId:"",stateId:"",districtId:"",city:"",pincode:"",mobileNo:"",identificationType:"",registrationNo:"",employmentTypeId:"",employeeTypeId:"",roleId:"",fromDate:"",deprtId:"",qualification:[{employeeQualificationId:1,institutionName:"",completionYear:"",qualificationName:"",filePath:null}],document:[{employeeDocumentId:1,documentName:"",filePath:null}]},[a,t]=(0,s.useState)(e),[c,d]=(0,s.useState)(""),[m,p]=(0,s.useState)(""),[h,u]=(0,s.useState)(null),[f,x]=(0,s.useState)(!1),[N,y]=(0,s.useState)([]),[j,g]=(0,s.useState)(!1),[b,v]=(0,s.useState)([]),[I,C]=(0,s.useState)([]),[q,A]=(0,s.useState)([]),[P,S]=(0,s.useState)([]),[w,D]=(0,s.useState)([]),[T,E]=(0,s.useState)([]),[$,L]=(0,s.useState)([]),[U,R]=(0,s.useState)([]),[k,F]=(0,s.useState)(""),[Y,M]=(0,s.useState)(""),O=sessionStorage.getItem("token")||localStorage.getItem("token");console.log("form",a);const Q=15,B=(new Date).toISOString().split("T")[0];(0,s.useEffect)((()=>{W(),z(),X(),Z(),_(),H(),K()}),[]);const G=function(e){p({message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",onClose:()=>{p(null)}})},W=async()=>{x(!0);try{const e=await(0,i.iq)(`${r.t1}/getAllCountries/1`);200===e.status&&Array.isArray(e.response)?v(e.response):(console.error("Unexpected API response format:",e),v([]))}catch(e){console.error("Error fetching country data:",e)}finally{x(!1)}},z=async()=>{x(!0);try{const e=await(0,i.iq)(`${r.Xw}/getAllDepartments/1`);200===e.status&&Array.isArray(e.response)?y(e.response):(console.error("Unexpected API response format:",e),y([]))}catch(e){console.error("Error fetching Department data:",e)}finally{x(!1)}},J=async e=>{x(!0);try{const a=`${r.qj}/country/${e}`,t=await(0,i.iq)(a);200===t.status&&Array.isArray(t.response)?C(t.response):(console.error("Unexpected API response format:",t),C([]))}catch(a){console.error("Error fetching state data:",a)}finally{x(!1)}},V=async e=>{x(!0);try{const a=`${r.fV}/state/${e}`,t=await(0,i.iq)(a);200===t.status&&Array.isArray(t.response)?A(t.response):(console.error("Unexpected API response format:",t),A([]))}catch(a){console.error("Error fetching city data:",a)}finally{x(!1)}},X=async()=>{x(!0);try{const e=await(0,i.iq)(`${r.WO}/getAll/1`);200===e.status&&Array.isArray(e.response)?S(e.response):(console.error("Unexpected API response format:",e),S([]))}catch(e){console.error("Error fetching Gender data:",e)}finally{x(!1)}},Z=async()=>{x(!0);try{const e=await(0,i.iq)(`${r.Si}/getAllIdentificationTypes/1`);200===e.status&&Array.isArray(e.response)?D(e.response):(console.error("Unexpected API response format:",e),D([]))}catch(e){console.error("Error fetching IdType data:",e)}finally{x(!1)}},H=async()=>{x(!0);try{const e=await(0,i.iq)(`${r.W1}/getAllUserType/1`);200===e.status&&Array.isArray(e.response)?L(e.response):(console.error("Unexpected API response format:",e),L([]))}catch(e){console.error("Error fetching EmployeeType data:",e)}finally{x(!1)}},K=async()=>{x(!0);try{const e=await(0,i.iq)(`${r.c7}/getAllEmploymentType/1`);200===e.status&&Array.isArray(e.response)?R(e.response):(console.error("Unexpected API response format:",e),R([]))}catch(e){console.error("Error fetching EmploymentType data:",e)}finally{x(!1)}},_=async()=>{x(!0);try{const e=await(0,i.iq)(`${r.BI}/1`);200===e.status&&Array.isArray(e.response)?E(e.response):(console.error("Unexpected API response format:",e),E([]))}catch(e){console.error("Error fetching Role data:",e)}finally{x(!1)}},ee=e=>{const{id:a,value:s}=e.target,l=s.replace(/\D/g,"");t((e=>({...e,[a]:l})))},ae=e=>{const{id:a,value:s}=e.target;t((e=>({...e,[a]:s})))},te=(e,a,s)=>{t((t=>({...t,qualification:t.qualification.map(((t,l)=>l===e?{...t,[a]:s}:t))})))},se=(e,a,s)=>{t((t=>({...t,document:t.document.map(((t,l)=>l===e?{...t,[a]:s}:t))})))},le=()=>{if(!(()=>{const e=["firstName","lastName","dob","genderId","address1","countryId","stateId","districtId","city","pincode","mobileNo","identificationType","registrationNo"];for(const t of e)if(!a[t])return G(`Please fill in the required field: ${t.replace(/([A-Z])/g," $1").replace(/^./,(e=>e.toUpperCase()))}`,"error"),!1;return a.profilePicName?!!a.idDocumentName||(G("ID document is required","error"),!1):(G("Profile picture is required","error"),!1)})())return null;const e=new FormData;return e.append("firstName",a.firstName),e.append("lastName",a.lastName),a.middleName&&e.append("middleName",a.middleName),e.append("dob",new Date(a.dob).toISOString().split("T")[0]),e.append("genderId",a.genderId),e.append("address1",a.address1),e.append("countryId",a.countryId),e.append("stateId",a.stateId),e.append("districtId",a.districtId),e.append("city",a.city),e.append("pincode",a.pincode),e.append("mobileNo",a.mobileNo),e.append("registrationNo",a.registrationNo),e.append("identificationType",a.identificationType),e.append("employeeTypeId",a.employeeTypeId),e.append("employmentTypeId",a.employmentTypeId),e.append("roleId",a.roleId),e.append("fromDate",new Date(a.fromDate).toISOString()),a.deprtId&&e.append("departmentId",a.deprtId),a.profilePicName&&e.append("profilePicName",a.profilePicName),a.idDocumentName&&e.append("idDocumentName",a.idDocumentName),a.qualification.forEach(((a,t)=>{e.append(`qualification[${t}].employeeQualificationId`,a.employeeQualificationId||""),e.append(`qualification[${t}].institutionName`,a.institutionName),e.append(`qualification[${t}].completionYear`,a.completionYear),e.append(`qualification[${t}].qualificationName`,a.qualificationName),a.filePath&&e.append(`qualification[${t}].filePath`,a.filePath)})),a.document.forEach(((a,t)=>{e.append(`document[${t}].employeeDocumentId`,a.employeeDocumentId||""),e.append(`document[${t}].documentName`,a.documentName),a.filePath&&e.append(`document[${t}].filePath`,a.filePath)})),e},re=()=>{t(e)};return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:"d-flex body py-3",children:(0,o.jsxs)("div",{className:"container-xxl",children:[m&&(0,o.jsx)(n.A,{message:m.message,type:m.type,onClose:m.onClose}),(0,o.jsx)("div",{className:"row align-items-center",children:(0,o.jsx)("div",{className:"border-0 mb-4",children:(0,o.jsx)("div",{className:"d-flex flex-wrap card-header align-items-center bg-transparent border-bottom justify-content-between px-0 py-3",children:(0,o.jsx)("h3",{className:"fw-bold mb-0",children:"Register of Employee"})})})}),(0,o.jsx)("div",{className:"row mb-3",children:(0,o.jsx)("div",{className:"col-sm-12",children:(0,o.jsxs)("div",{className:"card shadow mb-3",children:[(0,o.jsx)("div",{className:"card-header bg-light border-bottom-1 py-3",children:(0,o.jsx)("h6",{className:"fw-bold mb-0",children:"Employee Registration"})}),(0,o.jsx)("div",{className:"card-body",children:(0,o.jsx)("form",{children:(0,o.jsxs)("div",{className:"g-3 row",children:[(0,o.jsx)("div",{className:"col-md-9",children:(0,o.jsxs)("div",{className:"g-3 row",children:[(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"First Name *"}),(0,o.jsx)("input",{type:"text",required:!0,className:"form-control",id:"firstName",placeholder:"First Name",onChange:ae,value:a.firstName,maxLength:Q})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"Middle Name"}),(0,o.jsx)("input",{type:"text",className:"form-control",id:"middleName",placeholder:"Middle Name",onChange:ae,value:a.middleName,maxLength:Q})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"Last Name *"}),(0,o.jsx)("input",{type:"text",required:!0,className:"form-control",id:"lastName",placeholder:"Last Name",onChange:ae,value:a.lastName,maxLength:Q})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"Date of Birth *"}),(0,o.jsx)("input",{type:"date",required:!0,id:"dob",value:a.dob,className:"form-control",onChange:ae})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"Gender *"}),(0,o.jsxs)("select",{className:"form-select",style:{paddingRight:"40px"},value:a.genderId,onChange:e=>{return a=parseInt(e.target.value,10),void t((e=>({...e,genderId:a})));var a},disabled:f,children:[(0,o.jsx)("option",{value:"",children:"Select Gender"}),P.map((e=>(0,o.jsx)("option",{value:e.id,children:e.genderName},e.id)))]})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"Address *"}),(0,o.jsx)("textarea",{required:!0,id:"address1",value:a.address1,className:"form-control",onChange:ae,placeholder:"Address"})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"Country *"}),(0,o.jsxs)("select",{className:"form-select",value:a.countryId,onChange:e=>{const a=b.find((a=>a.id.toString()===e.target.value));var s,l;s=a.countryCode,l=a.id,t((e=>({...e,countryId:l,stateId:"",districtId:""}))),J(s),F(a.id),J(a.id)},disabled:f,children:[(0,o.jsx)("option",{value:"",children:"Select Country"}),b.map((e=>(0,o.jsx)("option",{value:e.id,children:e.countryName},e.id)))]})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"State *"}),(0,o.jsxs)("select",{className:"form-select",value:a.stateId,onChange:e=>{const a=I.find((a=>a.id.toString()===e.target.value));var s,l;s=a.stateCode,l=a.id,t((e=>({...e,stateId:l,districtId:""}))),V(s),M(a.id),V(a.id)},disabled:f||!a.countryId,children:[(0,o.jsx)("option",{value:"",children:"Select State"}),I.map((e=>(0,o.jsx)("option",{value:e.id,children:e.stateName},e.id)))]})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"District *"}),(0,o.jsxs)("select",{className:"form-select",value:a.districtId,onChange:e=>{return a=e.target.value,void t((e=>({...e,districtId:a})));var a},disabled:f||!a.stateId,children:[(0,o.jsx)("option",{value:"",children:"Select District"}),q.map((e=>(0,o.jsx)("option",{value:e.id,children:e.districtName},e.id)))]})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"City *"}),(0,o.jsx)("input",{type:"text",required:!0,className:"form-control",id:"city",placeholder:"City",onChange:ae,value:a.city,maxLength:Q})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"Pincode *"}),(0,o.jsx)("input",{type:"text",required:!0,className:"form-control",id:"pincode",placeholder:"Pincode",onChange:ee,value:a.pincode,maxLength:6,minLength:6,inputMode:"numeric",pattern:"\\d*"})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"Mobile No. *"}),(0,o.jsx)("input",{type:"text",required:!0,className:"form-control",id:"mobileNo",placeholder:"Mobile No.",onChange:ee,value:a.mobileNo,maxLength:10,minLength:10,inputMode:"numeric",pattern:"\\d*"})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"ID Type *"}),(0,o.jsxs)("select",{className:"form-select",style:{paddingRight:"40px"},value:a.identificationType,onChange:e=>{return a=parseInt(e.target.value,10),void t((e=>({...e,identificationType:a})));var a},disabled:f,children:[(0,o.jsx)("option",{value:"",children:"Select ID Type"}),w.map((e=>(0,o.jsx)("option",{value:e.identificationTypeId,children:e.identificationName},e.identificationTypeId)))]})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"ID Number *"}),(0,o.jsx)("input",{type:"text",required:!0,className:"form-control",id:"registrationNo",placeholder:"ID Number",onChange:ae,value:a.registrationNo,maxLength:Q})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"ID Upload (JPEG/PDF) *"}),(0,o.jsx)("input",{type:"file",id:"idDocumentName",className:"form-control mt-2",accept:".jpg,.jpeg,.png,.pdf",onChange:e=>t({...a,idDocumentName:e.target.files[0]})})]}),j&&(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"Depatment Name *"}),(0,o.jsxs)("select",{className:"form-select",style:{paddingRight:"40px"},value:a.deprtId,onChange:e=>{return a=parseInt(e.target.value,10),void t((e=>({...e,deprtId:a})));var a},disabled:f,children:[(0,o.jsx)("option",{value:"",children:"Select Depatment"}),N.map((e=>(0,o.jsx)("option",{value:e.id,children:e.departmentName},e.id)))]})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"Employee Type *"}),(0,o.jsxs)("select",{className:"form-select",style:{paddingRight:"40px"},value:a.employeeTypeId,onChange:e=>{return a=parseInt(e.target.value,10),void t((e=>({...e,employeeTypeId:a})));var a},disabled:f,children:[(0,o.jsx)("option",{value:"",children:"Select Employee Type"}),$.map((e=>(0,o.jsx)("option",{value:e.userTypeId,children:e.userTypeName},e.userTypeId)))]})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"Employment Type *"}),(0,o.jsxs)("select",{className:"form-select",style:{paddingRight:"40px"},value:a.employmentTypeId,onChange:e=>{return a=parseInt(e.target.value,10),void t((e=>({...e,employmentTypeId:a})));var a},disabled:f,children:[(0,o.jsx)("option",{value:"",children:"Select Employment Type"}),U.map((e=>(0,o.jsx)("option",{value:e.id,children:e.employmentType},e.id)))]})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"Role *"}),(0,o.jsxs)("select",{className:"form-select",style:{paddingRight:"40px"},value:a.roleId,onChange:e=>{return a=parseInt(e.target.value,10),void t((e=>({...e,roleId:a})));var a},disabled:f,children:[(0,o.jsx)("option",{value:"",children:"Select Role"}),T.map((e=>(0,o.jsx)("option",{value:e.id,children:e.roleDesc},e.id)))]})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"Period of Employment From Date"}),(0,o.jsx)("input",{type:"date",id:"fromDate",value:a.fromDate,className:"form-control",onChange:ae,min:B})]})]})}),(0,o.jsxs)("div",{className:"col-md-3 d-flex flex-column",children:[(0,o.jsx)("label",{className:"form-label",children:"Profile Image *"}),(0,o.jsxs)("div",{className:"d-flex flex-column align-items-center border p-2",children:[(0,o.jsx)("img",{src:a.profilePicPreview||l,alt:"Profile",className:"img-fluid",style:{objectFit:"cover",maxWidth:"100%",height:"150px"}}),(0,o.jsx)("input",{type:"file",id:"profilePicName",className:"form-control mt-2",accept:"image/*",onChange:e=>{const a=e.target.files[0];if(a){const e=new FileReader;e.onloadend=()=>{t((t=>({...t,profilePicName:a,profilePicPreview:e.result})))},e.readAsDataURL(a)}}})]})]})]})})})]})})}),(0,o.jsx)("div",{className:"row mb-3",children:(0,o.jsx)("div",{className:"col-sm-12",children:(0,o.jsxs)("div",{className:"card shadow mb-3",children:[(0,o.jsx)("div",{className:"card-header bg-light border-bottom-1 py-3",children:(0,o.jsx)("h6",{className:"fw-bold mb-0",children:"Educational Qualification"})}),(0,o.jsxs)("div",{className:"card-body",children:[(0,o.jsxs)("table",{className:"table table-bordered",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:"S.No"}),(0,o.jsx)("th",{children:"Degree"}),(0,o.jsx)("th",{children:"Name of Institution"}),(0,o.jsx)("th",{children:"Year of Completion"}),(0,o.jsx)("th",{children:"File Upload"}),(0,o.jsx)("th",{children:"Action"})]})}),(0,o.jsx)("tbody",{children:a.qualification.map(((e,a)=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:a+1}),(0,o.jsx)("td",{children:(0,o.jsx)("input",{type:"text",className:"form-control",value:e.qualificationName,placeholder:"Degree",onChange:e=>te(a,"qualificationName",e.target.value),maxLength:Q})}),(0,o.jsx)("td",{children:(0,o.jsx)("input",{type:"text",className:"form-control",value:e.institutionName,placeholder:"Institution Name",onChange:e=>te(a,"institutionName",e.target.value),maxLength:Q})}),(0,o.jsx)("td",{children:(0,o.jsx)("input",{type:"text",className:"form-control",placeholder:"YYYY",value:e.completionYear,onChange:e=>((e,a,s)=>{const l=s.replace(/\D/g,"").slice(0,4);t((t=>({...t,qualification:t.qualification.map(((t,s)=>s===e?{...t,[a]:l}:t))})))})(a,"completionYear",e.target.value),maxLength:4,minLength:4,inputMode:"numeric",pattern:"\\d{4}"})}),(0,o.jsx)("td",{children:(0,o.jsx)("input",{type:"file",className:"form-control",onChange:e=>te(a,"filePath",e.target.files[0]),accept:".pdf,.jpg,.jpeg,.png"})}),(0,o.jsx)("td",{children:(0,o.jsx)("button",{type:"button",className:"btn btn-danger",onClick:()=>(e=>{t((a=>({...a,qualification:a.qualification.filter(((a,t)=>t!==e))})))})(a),children:(0,o.jsx)("i",{className:"icofont-close"})})})]},a)))})]}),(0,o.jsx)("button",{type:"button",className:"btn btn-success",onClick:e=>{e.preventDefault(),t((e=>({...e,qualification:[...e.qualification,{id:e.qualification.length+1,institutionName:"",completionYear:"",qualificationName:"",filePath:null}]})))},children:"Add Row +"})]})]})})}),(0,o.jsx)("div",{className:"row mb-3",children:(0,o.jsx)("div",{className:"col-sm-12",children:(0,o.jsxs)("div",{className:"card shadow mb-3",children:[(0,o.jsx)("div",{className:"card-header bg-light border-bottom-1 py-3",children:(0,o.jsx)("h6",{className:"fw-bold mb-0",children:"Required Documents"})}),(0,o.jsxs)("div",{className:"card-body",children:[(0,o.jsxs)("table",{className:"table table-bordered",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:"S.No"}),(0,o.jsx)("th",{children:"Document Name"}),(0,o.jsx)("th",{children:"File Upload"}),(0,o.jsx)("th",{children:"Action"})]})}),(0,o.jsx)("tbody",{children:a.document.map(((e,a)=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:a+1}),(0,o.jsx)("td",{children:(0,o.jsx)("input",{type:"text",className:"form-control",value:e.documentName,onChange:e=>se(a,"documentName",e.target.value),placeholder:"Document Name",maxLength:Q})}),(0,o.jsx)("td",{children:(0,o.jsx)("input",{type:"file",className:"form-control",onChange:e=>se(a,"filePath",e.target.files[0]),accept:".pdf,.jpg,.jpeg,.png"})}),(0,o.jsx)("td",{children:(0,o.jsx)("button",{type:"button",className:"btn btn-danger",onClick:()=>(e=>{t((a=>({...a,document:a.document.filter(((a,t)=>t!==e))})))})(a),children:(0,o.jsx)("i",{className:"icofont-close"})})})]},a)))})]}),(0,o.jsx)("button",{type:"button",className:"btn btn-success",onClick:()=>{t((e=>({...e,document:[...e.document,{id:e.document.length+1,documentName:"",filePath:null}]})))},children:"Add Row +"})]})]})})}),(0,o.jsxs)("div",{className:"d-flex justify-content-end mt-4",children:[(0,o.jsx)("button",{onClick:async()=>{const e=le();if(e){x(!0);try{const a=await fetch(`${r.QU}/${r.tr}/create`,{method:"POST",headers:{Authorization:`Bearer ${O}`,Accept:"application/json"},body:e}),t=await a.json();if(!a.ok||500===t.status)throw new Error(t.message||"Failed to create employee");G("Employee created successfully","success"),re()}catch(a){console.error("Error creating employee:",a),G(a.message||"Error submitting form. Please try again.","error")}finally{x(!1)}}},type:"button",className:"btn btn-primary me-2",disabled:f,children:f?"Saving...":"Save"}),(0,o.jsx)("button",{onClick:async()=>{const e=le();if(e){if(!a.deprtId)return g(!0),void G("Department is required for approval. Please select a department.","error");x(!0);try{const a=await fetch(`${r.QU}/${r.tr}/create-and-approve`,{method:"POST",headers:{Authorization:`Bearer ${O}`},body:e}),t=await a.json();if(!a.ok||500===t.status)throw new Error(t.message||`Failed with status: ${a.status}`);G("Employee created and approved successfully","success"),re()}catch(t){console.error("Error creating and approving employee:",t),G(t.message||"Error creating and approving employee","error")}finally{x(!1)}}},type:"button",className:"btn btn-primary",disabled:f,children:f?"Processing...":"Save & Approve"})]})]})})})}}}]);
//# sourceMappingURL=840.c6be487c.chunk.js.map