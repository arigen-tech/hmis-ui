"use strict";(self.webpackChunkhmis=self.webpackChunkhmis||[]).push([[501],{501:(e,t,a)=>{a.r(t),a.d(t,{default:()=>d});var s=a(43),n=a(533);const r=n.QU,o=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a;a=localStorage.token?{Authorization:`Bearer ${localStorage.getItem("token")}`}:{Authorization:`Bearer ${sessionStorage.getItem("token")}`};const s=await fetch(`${r}${e}`,{method:"GET",headers:{"Content-Type":"application/json",...a,...t}});if(!s.ok)throw new Error(`GET request failed: ${s.status}`);return await s.json()}catch(a){throw console.error("GET Error:",a),a}},l=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{let s;s=localStorage.token?{Authorization:`Bearer ${localStorage.getItem("token")}`}:{Authorization:`Bearer ${sessionStorage.getItem("token")}`};const n=await fetch(`${r}${e}`,{method:"POST",headers:{"Content-Type":"application/json",...s,...a},body:JSON.stringify(t)});if(!n.ok)throw new Error(`POST request failed: ${n.status}`);return await n.json()}catch(s){throw console.error("POST Error:",s),s}};var i=a(128),c=a(579);const d=()=>{const[e,t]=(0,s.useState)(""),[a,r]=(0,s.useState)(""),[d,m]=(0,s.useState)(""),[u,h]=(0,s.useState)(""),[p,x]=(0,s.useState)(""),[y,f]=(0,s.useState)(""),[j,v]=(0,s.useState)(""),[N,g]=(0,s.useState)(""),[b,T]=(0,s.useState)([]),[k,S]=(0,s.useState)([]),[I,w]=(0,s.useState)([]),[O,D]=(0,s.useState)(!1),[A,C]=(0,s.useState)(null),$=function(e){r({message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",onClose:()=>{r(null)}})},E=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],q=E.reduce(((e,t)=>(e[t]={startToken:"",totalInterval:"",totalToken:"",totalOnlineToken:"",maxNoOfDays:"",minNoOfDays:""},e)),{}),[P,U]=(0,s.useState)(q);(0,s.useEffect)((()=>{z(),F()}),[]),(0,s.useEffect)((()=>{d&&B()}),[d]);const z=async()=>{D(!0);try{const e=await o(`${n.Xw}/all`);200===e.status&&Array.isArray(e.response)?T(e.response):(console.error("Unexpected API response format:",e),T([]))}catch(e){console.error("Error fetching Department data:",e)}finally{D(!1)}},B=async()=>{D(!0);try{const e=await o(`${n.Xw}/userDepartments/${d}`);200===e.status&&Array.isArray(e.response)?S(e.response):(console.error("Unexpected API response format:",e),S([]))}catch(e){console.error("Error fetching Doctor data:",e)}finally{D(!1)}},F=async()=>{D(!0);try{const e=await o(`${n.fW}/all`);200===e.status&&Array.isArray(e.response)?w(e.response):(console.error("Unexpected API response format:",e),w([]))}catch(e){console.error("Error fetching Session data:",e)}finally{D(!1)}};console.log(k),(0,s.useEffect)((()=>{d&&u&&p&&G()}),[d,u,p]);const G=async()=>{try{D(!0);const e=`${n.Yc}/find?deptId=${d}&doctorId=${u}&sessionId=${p}`,t=await o(e);if(200===(null===t||void 0===t?void 0:t.status)&&null!==t&&void 0!==t&&t.response){const{startTime:e,endTime:a,timeTaken:s,days:n}=t.response;if(C(t.response),f(e),v(a),g(s),Array.isArray(n)){const e={...q};n.forEach((t=>{const a=t.days||t.day;a&&e[a]&&(e[a]={startToken:t.startToken||"",totalInterval:t.totalInterval||"",totalToken:t.totalToken||"",totalOnlineToken:t.totalOnlineToken||"",maxNoOfDays:t.maxNoOfDays||"",minNoOfDays:t.minNoOfDays||""})})),U(e)}}else C(null),U(q)}catch(e){console.error("Error fetching appointment data:",e)}finally{D(!1)}},M=(e,t,a)=>{U({...P,[e]:{...P[e],[t]:a}})},W=()=>{m(""),h(""),x(""),f(""),v(""),g(""),U(q),C(null)};return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("div",{className:"body d-flex py-3",children:(0,c.jsxs)("div",{className:"container-xxl",children:[a&&(0,c.jsx)(i.A,{message:a.message,type:a.type,onClose:a.onClose}),(0,c.jsx)("div",{className:"row align-items-center",children:(0,c.jsx)("div",{className:"border-0 mb-4",children:(0,c.jsx)("div",{className:"card-header py-3 bg-transparent d-flex align-items-center px-0 justify-content-between border-bottom flex-wrap",children:(0,c.jsx)("h3",{className:"fw-bold mb-0",children:"Appointment Setup"})})})}),(0,c.jsx)("div",{className:"row mb-3",children:(0,c.jsx)("div",{className:"col-sm-12",children:(0,c.jsx)("div",{className:"card shadow mb-3",children:(0,c.jsx)("div",{className:"card-body",children:(0,c.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const t={id:A?A.id:null,departmentId:d,doctorId:u,sessionId:p,startTime:y,endTime:j,timeTaken:N,days:E.map((e=>{var t;const a=null===A||void 0===A||null===(t=A.days)||void 0===t?void 0:t.find((t=>(t.days||t.day)===e));return{id:A&&(null===a||void 0===a?void 0:a.id)||null,day:e,tokenStartNo:P[e].startToken,tokenInterval:P[e].totalInterval,totalToken:P[e].totalToken,totalOnlineToken:P[e].totalOnlineToken,maxNoOfDay:P[e].maxNoOfDays,minNoOfday:P[e].minNoOfDays}}))};console.log(t);try{D(!0);const e=await l(`${n.Yc}/setup`,t);A&&200===e.status||!A&&201===e.status?($(e.message||`Appointment ${A?"updated":"created"} successfully!`,"success"),W()):$(`Failed to ${A?"update":"create"} Appointment. Please try again.`,"error")}catch(a){$("An error occurred: "+(a.message||"Unknown error"),"error")}finally{D(!1)}},children:[(0,c.jsxs)("div",{className:"row g-3",children:[(0,c.jsxs)("div",{className:"col-md-4",children:[(0,c.jsx)("label",{className:"form-label",children:"Department *"}),(0,c.jsxs)("select",{className:"form-select",value:d,onChange:e=>m(parseInt(e.target.value)),required:!0,children:[(0,c.jsx)("option",{value:"",disabled:!0,children:"Select"}),b.map((e=>(0,c.jsx)("option",{value:e.id,children:e.departmentName},e.id)))]})]}),(0,c.jsxs)("div",{className:"col-md-4",children:[(0,c.jsx)("label",{className:"form-label",children:"Doctor List *"}),(0,c.jsxs)("select",{className:"form-select",value:u,onChange:e=>h(parseInt(e.target.value)),required:!0,disabled:!d,children:[(0,c.jsx)("option",{value:"",children:"Select Doctor"}),k.filter((e=>e.departmentId===parseInt(d))).map((e=>(0,c.jsx)("option",{value:e.userId,children:e.userName},e.userId)))]})]}),(0,c.jsxs)("div",{className:"col-md-4",children:[(0,c.jsx)("label",{className:"form-label",children:"Session *"}),(0,c.jsxs)("select",{className:"form-select",value:p,onChange:e=>x(parseInt(e.target.value)),required:!0,children:[(0,c.jsx)("option",{value:"",disabled:!0,children:"Select"}),I.map((e=>(0,c.jsx)("option",{value:e.id,children:e.sessionName},e.id)))]})]}),(0,c.jsxs)("div",{className:"col-md-4",children:[(0,c.jsx)("label",{className:"form-label",children:"Start Time *"}),(0,c.jsx)("input",{type:"time",className:"form-control",value:y,onChange:e=>f(e.target.value),required:!0})]}),(0,c.jsxs)("div",{className:"col-md-4",children:[(0,c.jsx)("label",{className:"form-label",children:"End Time *"}),(0,c.jsx)("input",{type:"time",className:"form-control",value:j,onChange:e=>v(e.target.value),required:!0})]}),(0,c.jsxs)("div",{className:"col-md-4",children:[(0,c.jsx)("label",{className:"form-label",children:"Time Taken (minutes) *"}),(0,c.jsx)("input",{type:"number",className:"form-control",value:N,onChange:e=>g(parseInt(e.target.value)),required:!0})]}),(0,c.jsx)("div",{className:"col-md-12",children:(0,c.jsxs)("table",{className:"table table-bordered",children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{children:"Days"}),(0,c.jsx)("th",{children:"Token Start No."}),(0,c.jsx)("th",{children:"Token Interval"}),(0,c.jsx)("th",{children:"Total Token"}),(0,c.jsx)("th",{children:"Total Online Token"}),(0,c.jsx)("th",{children:"Max No. of Days"}),(0,c.jsx)("th",{children:"Min No. of Days"})]})}),(0,c.jsx)("tbody",{children:E.map((e=>(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:e}),(0,c.jsx)("td",{children:(0,c.jsx)("input",{type:"text",className:"form-control",value:P[e].startToken,onChange:t=>M(e,"startToken",parseInt(t.target.value)||0)})}),(0,c.jsx)("td",{children:(0,c.jsx)("input",{type:"text",className:"form-control",value:P[e].totalInterval,onChange:t=>M(e,"totalInterval",parseInt(t.target.value)||0)})}),(0,c.jsx)("td",{children:(0,c.jsx)("input",{type:"text",className:"form-control",value:P[e].totalToken,onChange:t=>M(e,"totalToken",parseInt(t.target.value)||0)})}),(0,c.jsx)("td",{children:(0,c.jsx)("input",{type:"text",className:"form-control",value:P[e].totalOnlineToken,onChange:t=>M(e,"totalOnlineToken",parseInt(t.target.value)||0)})}),(0,c.jsx)("td",{children:(0,c.jsx)("input",{type:"text",className:"form-control",value:P[e].maxNoOfDays,onChange:t=>M(e,"maxNoOfDays",parseInt(t.target.value)||0)})}),(0,c.jsx)("td",{children:(0,c.jsx)("input",{type:"text",className:"form-control",value:P[e].minNoOfDays,onChange:t=>M(e,"minNoOfDays",parseInt(t.target.value)||0)})})]},e)))})]})})]}),(0,c.jsxs)("div",{className:"mt-4",children:[(0,c.jsx)("button",{type:"submit",className:"btn btn-primary me-2",disabled:O,children:O?"Processing...":A?"Update Appointment":"Create Appointment"}),(0,c.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:W,children:"Reset"})]})]})})})})})]})})})}}}]);
//# sourceMappingURL=501.de49aebe.chunk.js.map